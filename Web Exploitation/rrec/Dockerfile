FROM php:8.1.0-fpm

RUN useradd -m ctf

WORKDIR /home/ctf
RUN mkdir /home/ctf/chall

COPY ./*.php /home/ctf/chall/
COPY ./flag.txt /home/ctf/flag.txt

RUN chmod 777 /home/ctf/flag.txt

WORKDIR /home/ctf/chall

RUN mkdir storage && chmod 777 storage

USER ctf

EXPOSE 80
CMD php -S 0.0.0.0:80